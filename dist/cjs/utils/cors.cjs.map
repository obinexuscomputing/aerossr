{"version":3,"file":"cors.cjs","sources":["../../../../src/utils/cors.ts"],"sourcesContent":["import { ServerResponse } from 'http';\r\n\r\nexport interface CorsOptions {\r\n  origins?: string | string[];\r\n  methods?: string[];\r\n  allowedHeaders?: string[];\r\n  exposedHeaders?: string[];\r\n  credentials?: boolean;\r\n  maxAge?: number;\r\n}\r\n\r\nexport function setCorsHeaders(res: ServerResponse, options: CorsOptions = {}): void {\r\n  const {\r\n    origins = '*',\r\n    methods = ['GET', 'POST', 'OPTIONS', 'HEAD'],\r\n    allowedHeaders = ['Content-Type', 'Authorization'],\r\n    exposedHeaders = [],\r\n    credentials = false,\r\n    maxAge = 86400\r\n  } = options;\r\n\r\n  res.setHeader('Access-Control-Allow-Origin', Array.isArray(origins) ? origins.join(',') : origins);\r\n  res.setHeader('Access-Control-Allow-Methods', methods.join(', '));\r\n  res.setHeader('Access-Control-Allow-Headers', allowedHeaders.join(', '));\r\n  \r\n  if (exposedHeaders.length) {\r\n    res.setHeader('Access-Control-Expose-Headers', exposedHeaders.join(', '));\r\n  }\r\n  \r\n  if (credentials) {\r\n    res.setHeader('Access-Control-Allow-Credentials', 'true');\r\n  }\r\n  \r\n  res.setHeader('Access-Control-Max-Age', maxAge.toString());\r\n}\r\n\r\n// Helper functions\r\nexport function normalizeCorsOptions(options: string | CorsOptions | undefined): CorsOptions {\r\n  if (typeof options === 'string') {\r\n    return { origins: options };\r\n  }\r\n  return options || { origins: '*' };\r\n}\r\n\r\nexport function isPromise(value: any): value is Promise<unknown> {\r\n  return value instanceof Promise || (!!value && typeof value.then === 'function');\r\n}\r\n\r\nexport function ensureAsync<T extends (...args: any[]) => any>(\r\n  fn: T\r\n): (...args: Parameters<T>) => Promise<ReturnType<T>> {\r\n  return async (...args) => {\r\n    const result = fn(...args);\r\n    return isPromise(result) ? result : Promise.resolve(result);\r\n  };\r\n}"],"names":[],"mappings":";;SAWgB,cAAc,CAAC,GAAmB,EAAE,UAAuB,EAAE,EAAA;AAC3E,IAAA,MAAM,EACJ,OAAO,GAAG,GAAG,EACb,OAAO,GAAG,CAAC,KAAK,EAAE,MAAM,EAAE,SAAS,EAAE,MAAM,CAAC,EAC5C,cAAc,GAAG,CAAC,cAAc,EAAE,eAAe,CAAC,EAClD,cAAc,GAAG,EAAE,EACnB,WAAW,GAAG,KAAK,EACnB,MAAM,GAAG,KAAK,EACf,GAAG,OAAO,CAAC;IAEZ,GAAG,CAAC,SAAS,CAAC,6BAA6B,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,OAAO,CAAC,CAAC;AACnG,IAAA,GAAG,CAAC,SAAS,CAAC,8BAA8B,EAAE,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;AAClE,IAAA,GAAG,CAAC,SAAS,CAAC,8BAA8B,EAAE,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IAEzE,IAAI,cAAc,CAAC,MAAM,EAAE;AACzB,QAAA,GAAG,CAAC,SAAS,CAAC,+BAA+B,EAAE,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;AAC3E,KAAA;AAED,IAAA,IAAI,WAAW,EAAE;AACf,QAAA,GAAG,CAAC,SAAS,CAAC,kCAAkC,EAAE,MAAM,CAAC,CAAC;AAC3D,KAAA;IAED,GAAG,CAAC,SAAS,CAAC,wBAAwB,EAAE,MAAM,CAAC,QAAQ,EAAE,CAAC,CAAC;AAC7D,CAAC;AAED;AACM,SAAU,oBAAoB,CAAC,OAAyC,EAAA;AAC5E,IAAA,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;AAC/B,QAAA,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC;AAC7B,KAAA;AACD,IAAA,OAAO,OAAO,IAAI,EAAE,OAAO,EAAE,GAAG,EAAE,CAAC;AACrC,CAAC;AAEK,SAAU,SAAS,CAAC,KAAU,EAAA;AAClC,IAAA,OAAO,KAAK,YAAY,OAAO,KAAK,CAAC,CAAC,KAAK,IAAI,OAAO,KAAK,CAAC,IAAI,KAAK,UAAU,CAAC,CAAC;AACnF,CAAC;AAEK,SAAU,WAAW,CACzB,EAAK,EAAA;AAEL,IAAA,OAAO,OAAO,GAAG,IAAI,KAAI;AACvB,QAAA,MAAM,MAAM,GAAG,EAAE,CAAC,GAAG,IAAI,CAAC,CAAC;AAC3B,QAAA,OAAO,SAAS,CAAC,MAAM,CAAC,GAAG,MAAM,GAAG,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;AAC9D,KAAC,CAAC;AACJ;;;;;;;"}